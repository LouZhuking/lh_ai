好的，作为一名 AI 产品经理，我将为您构建一个基于先进 AI 技术的德州扑克翻牌前策略辅助工具的需求描述与实现方案。

---

### **产品需求文档（PRD）：AI 德州扑克翻牌前策略教练**

#### 1. 产品概述（Product Overview）

**产品名称：** PreFlop AI Coach

**产品愿景：** 为德州扑克爱好者（从初学者到进阶玩家）提供一个实时、数据驱动、且易于理解的翻牌前（Pre-Flop）策略决策辅助工具。产品旨在成为玩家的“私人策略官”，不仅给出行动建议，更能解释背后的逻辑，帮助用户学习和内化高级策略，而非单纯依赖提示。

**目标用户：**

1.  **扑克初学者：** 希望快速掌握起手牌价值、位置重要性等基础知识。
2.  **进阶业余玩家：** 希望优化自己的开局范围（Opening Range），纠正漏洞，适应不同牌桌动态。
3.  **内容创作者/教练：** 需要快速查询和验证特定场景下的标准策略，用于教学或直播。

#### 2. 问题陈述（Problem Statement）

德州扑克翻牌前的决策是整个牌局的基础，其复杂性在于：

- **信息不对称：** 玩家仅知道自己的两张手牌和位置。
- **决策维度多：** 最佳行动（加注、跟注、弃牌、全下）取决于**手牌强度**、**玩家位置**、**前方玩家动作**、**筹码深度**等多个变量。
- **策略动态变化：** 现代扑克策略是基于博弈论最优（GTO）和 exploitative 的混合体，知识体系庞大且不断演进。

传统解决方案（如静态的起手牌表格）无法应对所有复杂场景，且难以解释“为什么”，导致玩家难以举一反三。

#### 3. 核心功能需求（Core Functional Requirements）

1.  **策略查询（核心功能）：**

    - **输入：** 用户手动或通过 UI 选择输入：
      - a) 自己的两张**起手牌**（如：A♥ K♠）
      - b) 自己的**桌位位置**（如：按钮位、 cutoff、枪口位）
      - c) **当前牌局动作**（前面有几人平跟？有人加注了吗？加注量是多少？）
    - **输出：**
      - **主输出：** 一个清晰的**行动建议**（如：“建议加注至 3BB”或“建议弃牌”），并附有一个**置信度分数**。
      - **副输出（关键差异化功能）：** 一段**自然语言的解释**，说明为何给出此建议（例如：“你在按钮位，位置极佳，AKo 是顶级强牌，适合做加注来抢夺盲注并隔离后面的短筹码玩家。”）。

2.  **策略学习与探索：**
    - 用户可以不基于特定手牌，而是**查询概念性問題**，例如：“在枪口位应该用哪些牌开局？”“面对 3Bet 时，口袋对子 JJ 该怎么办？”
    - 系统应能返回从知识库中提取的相关策略片段和解释。

#### 4. 技术方案与实现（Technical Solution & Implementation）

我们将采用 **RAG（Retrieval-Augmented Generation）** 架构，完美结合您提到的技术点，确保建议的准确性和可解释性。

**架构图简述：**

```
[用户问题] -> (问题Embedding) -> [向量数据库检索] -> (最相关的策略知识) -> [LLM生成器] -> [结构化答案：建议+解释]
```

##### **阶段一：知识库构建与处理（Data Layer）**

1.  **数据源收集：**

    - 获取高质量的扑克策略资料，包括：
      - 权威书籍（如《Modern Poker Theory》）
      - 知名培训网站文章（如 Upswing Poker, RunItOnce）
      - 经过验证的 GTO 策略图表和数据（如解算器输出的范围数据）
    - 将这些非结构化的文本、图表和数据进行清洗和整理。

2.  **文本嵌入（Embedding）：**
    - 使用 Embedding 模型（如`text-embedding-ada-002`或开源的`BGE`模型）将知识库中的**每一段策略文本**转换为高维**向量（Vector）**。
    - 例如，将“在按钮位，你可以用前 40%的牌力进行开池加注”这句话转换为一个向量。
    - 将所有向量及其对应的原始文本存储到**向量数据库**中（如 ChromaDB, Pinecone, Weaviate）。

##### **阶段二：用户查询处理（Query Processing）**

3.  **问题嵌入（Question Embedding）：**
    - 当用户输入一个查询（如：“UTG 位置，手持 TT，前面无人入池，我该怎么办？”）时，系统使用**相同的 Embedding 模型**将该问题也转换为一个向量。

##### **阶段三：检索与生成（RAG Core）**

4.  **RAG 搜索（Retrieval）：**

    - 系统将用户的“问题向量”在向量数据库中进行**相似度搜索**（如余弦相似度）。
    - 检索出与用户问题**最相关的 K 个策略知识片段**（例如，K=3）。这些片段可能关于“TT 的价值”、“UTG 开局范围”、“口袋对子玩法”等。

5.  **返回内容生成回答（Generation）：**

    - 构建一个精心设计的**提示词（Prompt）**，提供给大语言模型（如 GPT-4、Claude 3 或本地部署的 Llama 3）。Prompt 模板如下：

      ```
      你是一名顶级的职业德州扑克教练。请根据以下<context>中的权威策略知识，为用户的问题提供建议。
      ```

       <context>
       [这里插入从向量数据库检索到的第1个相关策略片段]
       [这里插入从向量数据库检索到的第2个相关策略片段]
       [这里插入从向量数据库检索到的第3个相关策略片段]
       </context>

       <question>
       [这里插入用户的原问题]
       </question>

    请按以下格式严谨回答：

    1.  **行动建议**:（直接给出加注、跟注、弃牌或全下等建议，可包含具体数额如“加注到 2.5BB”）
    2.  **信心水平**:（高/中/低）
    3.  **原因解析**:（用通俗易懂的语言，综合上述知识，分点解释为什么给出这个建议。务必引用<context>中的知识，但不要直接复制原文。）

    注意：如果上下文信息不足或冲突，请说明这一点并给出最合理的推断。
    ```

    - LLM 根据提供的上下文（Context）和指令，生成一个**结构化、有据可依**的回答，最终呈现给用户。

#### 5. 成功指标（Success Metrics）

- **准确性：** 将产品建议与专业解算器（如 PioSOLVER）的输出进行对比，准确率目标 >95%。
- **响应时间：** 从用户提问到收到回答，95%的请求延迟 < 2 秒。
- **用户参与度：** 日均查询次数、用户会话时长。
- **学习效果（长期）：** 通过用户反馈和测试，衡量用户策略水平的提升。

#### 6. 后续迭代方向（Future Iterations）

1.  **个性化：** 引入用户牌局历史数据，提供更具针对性的 exploitative 建议（例如：“对手在 BB 位防守很宽，这里可以稍多加注”）。
2.  **场景扩展：** 从翻牌前扩展到翻牌后（Flop）、转牌（Turn）、河牌（River）的决策支持。
3.  **多人底池：** 支持更复杂的多人入池场景的决策。
4.  **语音输入/输出：** 方便玩家在多桌游戏或直播时使用。

---

**总结：**
本方案利用 **Embedding** 和 **RAG** 技术，将庞大的扑克策略知识库转化为一个可智能检索和推理的系统。它不仅能够根据**位置和起手牌**给出精准的决策方案，更能通过**生成式回答**解释原因，完美满足了用户“知其然更知其所以然”的深层需求，是一款真正具有教育价值的 AI 驱动产品。
